<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is a composite of identify_rows(), exclude(), restrict_n(), and restrict_dates(). It is aimed to implement case definition, e.g., two or more physician visits with some diagnostic code at least 30 days apart within two years, in one shot. The component functions are chained in the following order if all arguments were supplied (see the verbose output for what was done if some arguments are missing): identify_rows(vals) %&amp;gt;% exclude(identify_rows(excl_vals), by = clnt_id) %&amp;gt;% restrict_n() %&amp;gt;% restrict_dates()"><title>Identify diseases/events from administrative records — define_case • healthdb</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify diseases/events from administrative records — define_case"><meta property="og:description" content="This function is a composite of identify_rows(), exclude(), restrict_n(), and restrict_dates(). It is aimed to implement case definition, e.g., two or more physician visits with some diagnostic code at least 30 days apart within two years, in one shot. The component functions are chained in the following order if all arguments were supplied (see the verbose output for what was done if some arguments are missing): identify_rows(vals) %&amp;gt;% exclude(identify_rows(excl_vals), by = clnt_id) %&amp;gt;% restrict_n() %&amp;gt;% restrict_dates()"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">healthdb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Intro.html">Intro</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KevinHzq/healthdb/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Identify diseases/events from administrative records</h1>
      <small class="dont-index">Source: <a href="https://github.com/KevinHzq/healthdb/blob/HEAD/R/define_case.R" class="external-link"><code>R/define_case.R</code></a></small>
      <div class="d-none name"><code>define_case.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is a composite of <code><a href="identify_rows.html">identify_rows()</a></code>, <code><a href="exclude.html">exclude()</a></code>, <code><a href="restrict_n.html">restrict_n()</a></code>, and <code><a href="restrict_dates.html">restrict_dates()</a></code>. It is aimed to implement case definition, e.g., two or more physician visits with some diagnostic code at least 30 days apart within two years, in one shot. The component functions are chained in the following order if all arguments were supplied (see the verbose output for what was done if some arguments are missing): identify_rows(vals) %&gt;% exclude(identify_rows(excl_vals), by = clnt_id) %&gt;% restrict_n() %&gt;% restrict_dates()</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">define_case</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">vars</span>,</span>
<span>  match <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>  <span class="va">vals</span>,</span>
<span>  <span class="va">clnt_id</span>,</span>
<span>  n_per_clnt <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  date_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  apart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  uid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  excl_vals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  excl_args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"first"</span>, <span class="st">"last"</span><span class="op">)</span>,</span>
<span>  if_all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"flag"</span>, <span class="st">"filter"</span><span class="op">)</span>,</span>
<span>  force_collect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"healthdb.verbose"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>Data.frames or remote tables (e.g., from <code>vignette("dbplyr", package = "dbplyr)</code>)</p></dd>


<dt>vars</dt>
<dd><p>An expression passing to <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code>. It can be Quoted/unquoted column names, or helper functions, such as <code><a href="https://dplyr.tidyverse.org/reference/reexports.html" class="external-link">dplyr::starts_with()</a></code>.</p></dd>


<dt>match</dt>
<dd><p>One of "in", "start", "regex", "like", "between", and "glue_sql". It determines how values would be matched. See <code><a href="identify_rows.html">identify_rows()</a></code> for detail.</p></dd>


<dt>vals</dt>
<dd><p>Depending on <code>match</code>, it takes different input. See <code><a href="identify_rows.html">identify_rows()</a></code>.</p></dd>


<dt>clnt_id</dt>
<dd><p>Grouping variable (quoted/unquoted).</p></dd>


<dt>n_per_clnt</dt>
<dd><p>A single number specifying the minimum number of group size.</p></dd>


<dt>date_var</dt>
<dd><p>Variable name (quoted/unquoted) for the dates to be interpreted.</p></dd>


<dt>apart</dt>
<dd><p>An integer specifying the minimum gap (in days) between adjacent dates in a draw.</p></dd>


<dt>within</dt>
<dd><p>An integer specifying the maximum time span (in days) of a draw.</p></dd>


<dt>uid</dt>
<dd><p>Variable name for a unique row identifier. It is necessary for SQL to produce consistent result based on sorting.</p></dd>


<dt>excl_vals</dt>
<dd><p>Same as <code>vals</code> but groups with these values are going to be removed from the result.</p></dd>


<dt>excl_args</dt>
<dd><p>A named list of arguments for the second <code><a href="identify_rows.html">identify_rows()</a></code> call for <code>excl_vals</code>. If not supplied, <code>var</code>, <code>match</code> and <code>if_all</code> of the first call will be re-used.</p></dd>


<dt>keep</dt>
<dd><p>One of "first" (keeping each client's earliest record), "last" (keeping the latest), and "all" (keeping all relevant records, default). Note that "first"/"last" should not be used with "flag" mode.</p></dd>


<dt>if_all</dt>
<dd><p>A logical for whether combining the predicates (if multiple columns were selected by vars) with AND instead of OR. Default is FALSE, e.g., var1 in vals OR var2 in vals.</p></dd>


<dt>mode</dt>
<dd><p>Either "flag" - add new columns starting with "flag_" indicating if the client met the condition, or "filter" - remove clients that did not meet the condition from the data. It will be passed to both <code><a href="restrict_n.html">restrict_n()</a></code> AND <code><a href="restrict_dates.html">restrict_dates()</a></code>. Default is "flag".</p></dd>


<dt>force_collect</dt>
<dd><p>A logical for whether force downloading the result table if it is not a local data.frame. Downloading data could be slow, so the user has to opt in; default is FALSE.</p></dd>


<dt>verbose</dt>
<dd><p>A logical for whether printing explanation for the operation. Default is fetching from options. Use options(healthdb.verbose = FALSE) to suppress once and for all.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments, e.g., <code>mode</code>, passing to <code><a href="restrict_dates.html">restrict_dates()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A subset of input data satisfied the specified case definition.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  clnt_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  service_dt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-31"</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    size <span class="op">=</span> <span class="va">sample_size</span>, replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  diagx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span>, size <span class="op">=</span> <span class="va">sample_size</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  diagx_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">letters</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">sample_size</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  diagx_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">letters</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">sample_size</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define from one source</span></span></span>
<span class="r-in"><span><span class="fu">define_case</span><span class="op">(</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>  vars <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"diagx"</span><span class="op">)</span>, <span class="st">"in"</span>, vals <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  clnt_id <span class="op">=</span> <span class="va">clnt_id</span>, date_var <span class="op">=</span> <span class="va">service_dt</span>,</span></span>
<span class="r-in"><span>  excl_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>if_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="co"># remove non-case</span></span></span>
<span class="r-in"><span>  mode <span class="op">=</span> <span class="st">"filter"</span>,</span></span>
<span class="r-in"><span>  <span class="co"># keeping the first record</span></span></span>
<span class="r-in"><span>  keep <span class="op">=</span> <span class="st">"first"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------Inclusion step--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identify records with condition(s): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - where at least one of the diagx, diagx_1, diagx_2 column(s) in each record </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - contains a value exactly matched values in set: letters[1:4] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All unique value(s) and frequency in the result (as the conditions require just one of the columns containing target values; irrelevant values may come from other columns): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    a    b    c    d    e    f    g    i    k    l    n    o    q    r    s    u </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    w    z NA's </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    1    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------- Output first records--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clnt_id service_dt diagx diagx_1 diagx_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>       1 2020-01-01 e     o       b      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>       2 2020-01-02 n     b       n      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>       3 2020-01-03 q     d       w      </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># multiple sources with purrr::pmap</span></span></span>
<span class="r-in"><span><span class="co"># arguments with length = 1 will be recycle to match the number of sources</span></span></span>
<span class="r-in"><span><span class="co"># wrap expressions/unquoted variables with bquote(),</span></span></span>
<span class="r-in"><span><span class="co"># or rlang:exprs() to prevent immediate evaluation,</span></span></span>
<span class="r-in"><span><span class="co"># or just use quoted variable names</span></span></span>
<span class="r-in"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    vars <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"diagx"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    match <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"in"</span>, <span class="st">"start"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    clnt_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">clnt_id</span><span class="op">)</span><span class="op">)</span>, n_per_clnt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    date_var <span class="op">=</span> <span class="st">"service_dt"</span>,</span></span>
<span class="r-in"><span>    excl_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">14</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    excl_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>if_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>if_all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="va">define_case</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------Inclusion step--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identify records with condition(s): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - where at least one of the diagx, diagx_1, diagx_2 column(s) in each record </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - contains a value exactly matched values in set: c("a", "b", "c", "d") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All unique value(s) and frequency in the result (as the conditions require just one of the columns containing target values; irrelevant values may come from other columns): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    a    b    c    d    e    f    g    i    k    l    n    o    q    r    s    u </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    w    z NA's </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    1    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------Exclusion step--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identify records with condition(s): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - where all of the diagx, diagx_1, diagx_2 column(s) in each record </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - contains a value exactly matched values in set: c("k", "l", "m") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All unique value(s) and frequency in the result : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> integer(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exclude records in `data` through anti_join with `excl` matching on (by argument): "clnt_id" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Of the 3 "clnt_id" in data, 0 were excluded.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------No. rows restriction--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Of the 3 clients in the input, 0 were flagged as 0 by restricting that each client must have at least 2 records with distinct service_dt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------- Output all records--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------Inclusion step--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identify records with condition(s): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - where at least one of the diagx, diagx_1, diagx_2 column(s) in each record </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - contains a value satisfied regular expression: ^e|^f|^g|^h|^i|^j </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All unique value(s) and frequency in the result (as the conditions require just one of the columns containing target values; irrelevant values may come from other columns): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    a    b    d    e    f    g    h    i    j    k    o    r    s    t    u    w </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    x    y    z NA's </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    1    1    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------Exclusion step--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identify records with condition(s): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - where at least one of the diagx, diagx_1, diagx_2 column(s) in each record </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - contains a value satisfied regular expression: ^n|^o|^p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All unique value(s) and frequency in the result (as the conditions require just one of the columns containing target values; irrelevant values may come from other columns): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b e g l n o p t u </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1 1 1 1 1 1 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exclude records in `data` through anti_join with `excl` matching on (by argument): "clnt_id" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Of the 3 "clnt_id" in data, 3 were excluded.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------No. rows restriction--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Of the 0 clients in the input, 0 were flagged as 0 by restricting that each client must have at least 3 records with distinct service_dt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------- Output all records--------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    clnt_id service_dt diagx diagx_1 diagx_2 flag_restrict_n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        1 2020-01-04     w       f       a               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        1 2020-01-01     e       o       b               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        1 2020-01-03     a       e       e               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        2 2020-01-03     l       r       c               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        2 2020-01-15     u       r       d               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        2 2020-01-14     b       l       k               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        2 2020-01-03     d       f       s               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        2 2020-01-02     n       b       n               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        3 2020-01-27     z       g       a               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       3 2020-01-05     q    &lt;NA&gt;       b               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       3 2020-01-03     q       d       w               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       3 2020-01-12     b       d       i               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] clnt_id         service_dt      diagx           diagx_1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] diagx_2         flag_restrict_n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;0 rows&gt; (or 0-length row.names)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Kevin Hu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

